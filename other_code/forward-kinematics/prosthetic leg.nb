(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    123132,       3284]
NotebookOptionsPosition[    115146,       3151]
NotebookOutlinePosition[    115684,       3171]
CellTagsIndexPosition[    115641,       3168]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Model for Planar Leg with Floating Base", "Title",
 CellChangeTimes->{{3.520685501375*^9, 3.520685508328125*^9}, {
  3.5206861038125*^9, 3.52068610965625*^9}, {3.52076864303125*^9, 
  3.520768643921875*^9}, {3.52302822678125*^9, 3.52302823384375*^9}, {
  3.523029100546875*^9, 3.523029105234375*^9}, {3.543075071904307*^9, 
  3.543075073471307*^9}, {3.6075111217439766`*^9, 
  3.6075111340802107`*^9}},ExpressionUUID->"1ba14af8-ef33-4b83-af27-\
7981690e089b"],

Cell["\<\
Modeling by Robert D Gregg
rdgregg@umich.edu
02/04/2020\
\>", "Subsubtitle",
 CellChangeTimes->{{3.5111737331439896`*^9, 3.511173737039212*^9}, {
   3.520768651078125*^9, 3.520768659875*^9}, {3.521818801734375*^9, 
   3.521818813484375*^9}, {3.543075080431307*^9, 3.5430750818223066`*^9}, {
   3.555090980418681*^9, 3.5550909814106812`*^9}, {3.584383851432938*^9, 
   3.584383860711938*^9}, 3.5870539595811186`*^9, {3.6075111483526373`*^9, 
   3.6075111496437664`*^9}, {3.7620071580135727`*^9, 
   3.7620071607834682`*^9}, {3.7898275894789257`*^9, 
   3.7898275944800673`*^9}},ExpressionUUID->"4d6f21f6-8f60-4283-9c4c-\
49db68be2bcb"],

Cell[CellGroupData[{

Cell["Open Chain Kinematics (Hip reference frame)", "Section",
 CellChangeTimes->{{3.5870537102331862`*^9, 3.587053717215884*^9}, {
  3.6074403915863028`*^9, 
  3.6074403921843033`*^9}},ExpressionUUID->"7acdc1cf-3fe4-4b6b-87c0-\
d98ad0c0347e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"General", "::", "spell"}], ",", 
    RowBox[{"General", "::", "spell1"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{"\"\<Screws`\>\"", ",", "\"\<C://Mathematica//Screws.m\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
   "\"\<RobotLinks`\>\"", ",", "\"\<C://Mathematica//RobotLinks.m\>\""}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.433011357994742*^9, {3.5049628597113647`*^9, 3.50496286452464*^9}, {
   3.5263890533940296`*^9, 3.5263890535870295`*^9}, {3.5431470386141915`*^9, 
   3.5431470437021914`*^9}, {3.584384027173938*^9, 3.584384035981938*^9}, {
   3.7620071847534046`*^9, 3.762007186253627*^9}, {3.762007537793665*^9, 
   3.7620075628533974`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d11a497a-cb1a-445d-a11d-597d3ea78c8b"],

Cell[BoxData[
 TemplateBox[{
  "Get","noopen",
   "\"Cannot open \\!\\(\\*RowBox[{\\\"\\\\\\\"Graphics`Shapes`\\\\\\\"\\\"}]\
\\).\"",2,2,1,16468433997897611643,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.762007424503399*^9, {3.7620075555068617`*^9, 3.762007574433529*^9}, {
   3.7898372326342144`*^9, 3.7898372595547757`*^9}},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"7cbfb2ea-8f5c-49f8-b97c-161ba59eacf1"],

Cell[BoxData[
 TemplateBox[{
  "Needs","nocont",
   "\"Context \\!\\(\\*RowBox[{\\\"\\\\\\\"Graphics`Shapes`\\\\\\\"\\\"}]\\) \
was not created when Needs was evaluated.\"",2,2,2,16468433997897611643,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.762007424503399*^9, {3.7620075555068617`*^9, 3.762007574433529*^9}, {
   3.7898372326342144`*^9, 3.7898372596556363`*^9}},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"b977c9b5-2db2-4aa9-a479-5d6ce3363491"],

Cell[BoxData[
 TemplateBox[{
  "Get","noopen",
   "\"Cannot open \
\\!\\(\\*RowBox[{\\\"\\\\\\\"C://Mathematica//RobotLinks.m\\\\\\\"\\\"}]\\).\"\
",2,3,3,16468433997897611643,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.762007424503399*^9, {3.7620075555068617`*^9, 3.762007574433529*^9}, {
   3.7898372326342144`*^9, 3.789837259677914*^9}},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"c2a9f05c-609c-49f3-8d26-e08c6726368e"],

Cell[BoxData[
 TemplateBox[{
  "Needs","nocont",
   "\"Context \\!\\(\\*RowBox[{\\\"\\\\\\\"RobotLinks`\\\\\\\"\\\"}]\\) was \
not created when Needs was evaluated.\"",2,3,4,16468433997897611643,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.762007424503399*^9, {3.7620075555068617`*^9, 3.762007574433529*^9}, {
   3.7898372326342144`*^9, 3.7898372596946507`*^9}},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"162d50a1-aa5d-4ee7-ad13-4e2ece614206"]
}, Open  ]],

Cell["Define the configuration vector and its time derivatives:", "Text",
 CellChangeTimes->{{3.588002339670274*^9, 3.588002381259274*^9}, {
  3.588002750851274*^9, 
  3.5880027570192738`*^9}},ExpressionUUID->"32a41335-8637-4ad8-8472-\
732d463a5d57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"q", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q1", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q3", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q4", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q5", "[", "t", "]"}], "}"}]}], "}"}]}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Hipx", ",", " ", "Hipy", ",", " ", 
    RowBox[{"Thigh", " ", "angle"}], ",", " ", 
    RowBox[{"knee", " ", "angle"}], ",", " ", 
    RowBox[{"ankle", " ", "angle"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qdot", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"q", ",", "t"}], "]"}]}], ";", " ", 
  RowBox[{"qddot", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"qdot", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"q", ",", "qdot"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.5111737472017937`*^9, {3.511173782073788*^9, 3.5111737868600616`*^9}, {
   3.5111755940464272`*^9, 3.511175600408791*^9}, {3.520686131703125*^9, 
   3.520686135875*^9}, {3.520686309671875*^9, 3.520686312484375*^9}, {
   3.520687115453125*^9, 3.5206871275625*^9}, {3.52078867884375*^9, 
   3.52078872540625*^9}, {3.520857852828125*^9, 3.520857856765625*^9}, {
   3.521820034578125*^9, 3.52182003665625*^9}, {3.521820194515625*^9, 
   3.52182019925*^9}, {3.521911060609375*^9, 3.52191106496875*^9}, 
   3.5219945113125*^9, {3.523028145328125*^9, 3.523028147203125*^9}, 
   3.523028568734375*^9, {3.523033556203125*^9, 3.5230335580625*^9}, {
   3.52303366240625*^9, 3.523033664046875*^9}, {3.5232996586875*^9, 
   3.523299669890625*^9}, 3.523299712796875*^9, {3.52330022171875*^9, 
   3.523300234421875*^9}, {3.52330028559375*^9, 3.52330029028125*^9}, 
   3.5233008249375*^9, {3.523360415484375*^9, 3.523360421828125*^9}, {
   3.523380309234375*^9, 3.52338031990625*^9}, {3.523380358796875*^9, 
   3.523380364234375*^9}, {3.5287165611401763`*^9, 3.5287165746088295`*^9}, {
   3.543073868103307*^9, 3.543073894812307*^9}, 3.5430739902623067`*^9, {
   3.5430742662443066`*^9, 3.543074273445307*^9}, 3.5430744729683065`*^9, {
   3.5430748729733067`*^9, 3.5430748749423065`*^9}, 3.5559324334636097`*^9, {
   3.587053952262387*^9, 3.5870539539325533`*^9}, {3.5880028855252743`*^9, 
   3.588003008557274*^9}, {3.6074393050333633`*^9, 3.6074393160360613`*^9}, {
   3.607439399845911*^9, 3.607439400133825*^9}, {3.789837509487196*^9, 
   3.7898375099076056`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ba51fb9f-64bb-4d53-8738-2ab842e6a8d9"],

Cell["\<\
Define the joint axes at initial locations, starting with hip cartesian \
coordinates:\
\>", "Text",
 CellChangeTimes->{{3.588002339670274*^9, 3.588002381259274*^9}, {
  3.588002750851274*^9, 3.5880027570192738`*^9}, {3.6075110848052835`*^9, 
  3.607511113883191*^9}, {3.6075112965954604`*^9, 3.607511300200821*^9}, {
  3.607511606782476*^9, 
  3.6075116199387913`*^9}},ExpressionUUID->"bfa488ed-49b2-482b-884b-\
897297ba69e7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ax1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ax2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ax3", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"hip", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ax4", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "lt"}]}], " ", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"knee", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ax5", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "ls"}], "-", "lt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"ankle", " ", "axis"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.520686144890625*^9, 3.520686145203125*^9}, {
   3.52068617653125*^9, 3.520686205625*^9}, {3.520686284921875*^9, 
   3.520686305984375*^9}, {3.520686374484375*^9, 3.520686441609375*^9}, {
   3.52068650903125*^9, 3.520686509140625*^9}, {3.52068656871875*^9, 
   3.520686617546875*^9}, {3.5206873421875*^9, 3.520687418140625*^9}, {
   3.5207688911875*^9, 3.520768891421875*^9}, {3.5208577891875*^9, 
   3.5208577938125*^9}, {3.52182001190625*^9, 3.521820023734375*^9}, {
   3.521911082890625*^9, 3.52191115175*^9}, {3.52191125971875*^9, 
   3.521911294796875*^9}, {3.521911335375*^9, 3.5219113548125*^9}, {
   3.5219119563125*^9, 3.521911956390625*^9}, {3.521994532609375*^9, 
   3.521994535875*^9}, {3.52206939596875*^9, 3.5220694045625*^9}, {
   3.523028084703125*^9, 3.523028115890625*^9}, 3.523028291140625*^9, 
   3.523033323140625*^9, 3.523033450765625*^9, {3.52303353259375*^9, 
   3.5230335539375*^9}, {3.5230373085*^9, 3.52303737340625*^9}, {
   3.523037467328125*^9, 3.52303746903125*^9}, 3.52330047*^9, {
   3.523358999328125*^9, 3.52335906684375*^9}, {3.523360273125*^9, 
   3.523360357953125*^9}, {3.5233608009375*^9, 3.523360804421875*^9}, {
   3.52336423246875*^9, 3.52336423984375*^9}, 3.528716608959394*^9, {
   3.5378114879773455`*^9, 3.5378114882175856`*^9}, {3.539014808319905*^9, 
   3.5390148139360275`*^9}, {3.543073943307307*^9, 3.543074019945307*^9}, {
   3.5430740586903067`*^9, 3.543074064726307*^9}, {3.543075246569307*^9, 
   3.5430752470013065`*^9}, {3.5431422985871916`*^9, 3.543142308314192*^9}, {
   3.5439277592067757`*^9, 3.5439277644517756`*^9}, {3.5439278106917753`*^9, 
   3.5439278108357754`*^9}, 3.555929782255413*^9, {3.5562838168384066`*^9, 
   3.5562838172061853`*^9}, {3.607439391815321*^9, 3.607439438858204*^9}, {
   3.607511311200921*^9, 3.6075113130601063`*^9}, {3.7620072199837523`*^9, 
   3.762007249793788*^9}, {3.762007281443393*^9, 3.7620072991337695`*^9}, {
   3.789837580903446*^9, 3.7898375822584896`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"4b12a4d3-7eee-4754-8461-e3471f390e25"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7620072942344027`*^9, 3.7620074280045137`*^9, 
  3.762007579543623*^9, 3.7898377179703445`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"f19c519a-88e6-4500-b104-9f9dbb11b55f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", "lt"}], ",", "0", ",", "1", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7620072942344027`*^9, 3.7620074280045137`*^9, 
  3.762007579543623*^9, 3.78983771798067*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"6df52ef6-a40b-4d3a-9766-9aa6e4aa4f7c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"-", "ls"}], "-", "lt"}], ",", "0", ",", "1", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{3.7620072942344027`*^9, 3.7620074280045137`*^9, 
  3.762007579543623*^9, 3.7898377179948783`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"7f7cc41a-5664-4364-a2db-b476d226a763"]
}, Open  ]],

Cell["Define homogenous transformation matrices for each axis:", "Text",
 CellChangeTimes->{{3.6075111782266245`*^9, 3.6075111912639284`*^9}, 
   3.6075112223800397`*^9, {3.607511324848285*^9, 3.6075113333191323`*^9}, 
   3.607511558783676*^9},ExpressionUUID->"a8947e5c-cd87-4207-8966-\
1f0393ae5736"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"e1", " ", "=", " ", 
   RowBox[{"TwistExp", "[", 
    RowBox[{"ax1", ",", 
     RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"e2", " ", "=", " ", 
   RowBox[{"TwistExp", "[", 
    RowBox[{"ax2", ",", 
     RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"e3", " ", "=", " ", 
   RowBox[{"TwistExp", "[", 
    RowBox[{"ax3", ",", 
     RowBox[{"q3", "[", "t", "]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"e4", " ", "=", " ", 
   RowBox[{"TwistExp", "[", 
    RowBox[{"ax4", ",", 
     RowBox[{"q4", "[", "t", "]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"e5", " ", "=", " ", 
   RowBox[{"TwistExp", "[", 
    RowBox[{"ax5", ",", 
     RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7620073052436886`*^9, 3.7620073091377573`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"15f4ec07-f573-4943-b79e-ce5ada0e45c6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", 
      RowBox[{"q1", "[", "t", "]"}]},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.762007309660247*^9, 3.762007429658555*^9, 
  3.7620075815873446`*^9, 3.789837719725009*^9},
 CellLabel->
  "Out[15]//MatrixForm=",ExpressionUUID->"9138f251-854f-4e11-adc6-\
fc68e0ae65ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", 
      RowBox[{"q2", "[", "t", "]"}]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.762007309660247*^9, 3.762007429658555*^9, 
  3.7620075815873446`*^9, 3.789837719735648*^9},
 CellLabel->
  "Out[16]//MatrixForm=",ExpressionUUID->"4c57b98c-ee49-4411-9324-\
956c6c032051"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{"Cos", "[", 
       RowBox[{"q3", "[", "t", "]"}], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"q3", "[", "t", "]"}], "]"}]}], "0"},
     {"0", 
      RowBox[{"Sin", "[", 
       RowBox[{"q3", "[", "t", "]"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"q3", "[", "t", "]"}], "]"}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.762007309660247*^9, 3.762007429658555*^9, 
  3.7620075815873446`*^9, 3.7898377197580137`*^9},
 CellLabel->
  "Out[17]//MatrixForm=",ExpressionUUID->"f353f125-4471-4bee-83e3-\
b66b1f47315b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{"Cos", "[", 
       RowBox[{"q4", "[", "t", "]"}], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"q4", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "lt"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q4", "[", "t", "]"}], "]"}]}]},
     {"0", 
      RowBox[{"Sin", "[", 
       RowBox[{"q4", "[", "t", "]"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"q4", "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"-", "lt"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"q4", "[", "t", "]"}], "]"}]}], ")"}]}]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.762007309660247*^9, 3.762007429658555*^9, 
  3.7620075815873446`*^9, 3.789837719774207*^9},
 CellLabel->
  "Out[18]//MatrixForm=",ExpressionUUID->"85e20213-ea53-4975-8c37-\
aec647ac2971"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{"Cos", "[", 
       RowBox[{"q5", "[", "t", "]"}], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"q5", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "ls"}], "-", "lt"}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q5", "[", "t", "]"}], "]"}]}]},
     {"0", 
      RowBox[{"Sin", "[", 
       RowBox[{"q5", "[", "t", "]"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"q5", "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "ls"}], "-", "lt"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"q5", "[", "t", "]"}], "]"}]}], ")"}]}]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.762007309660247*^9, 3.762007429658555*^9, 
  3.7620075815873446`*^9, 3.7898377197924194`*^9},
 CellLabel->
  "Out[19]//MatrixForm=",ExpressionUUID->"04844baf-b101-4286-bed7-\
ce4e685bdfb8"]
}, Open  ]],

Cell["Define initial locations of link COMs:", "Text",
 CellChangeTimes->{{3.6075111782266245`*^9, 3.6075111912639284`*^9}, 
   3.6075112223800397`*^9, {3.607511324848285*^9, 3.6075113333191323`*^9}, {
   3.607511558783676*^9, 
   3.6075115999587936`*^9}},ExpressionUUID->"9aa40daf-cc6c-4049-a891-\
125ea0fb5b88"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gst00", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"hip", "/", "remaining"}], " ", "body", " ", "mass"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gst01", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "lt"}], "/", "2"}], ")"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{"stance", " ", "thigh"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gst02", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "lt"}], "-", 
          RowBox[{"ls", "/", "2"}]}], ")"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{"stance", " ", "shank"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gst03", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "lf"}], "/", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "lt"}], "-", "ls"}], ")"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{"stance", " ", "foot"}], "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.52068675271875*^9, 3.5206868401875*^9}, {
   3.52068688309375*^9, 3.520686884765625*^9}, {3.5206869316875*^9, 
   3.52068695546875*^9}, {3.52068703525*^9, 3.5206870995*^9}, {
   3.52068721059375*^9, 3.5206872309375*^9}, {3.520687329875*^9, 
   3.520687335984375*^9}, {3.520687447921875*^9, 3.520687482640625*^9}, {
   3.52085775021875*^9, 3.5208577569375*^9}, {3.52182002690625*^9, 
   3.521820029890625*^9}, {3.52199454090625*^9, 3.5219945435625*^9}, {
   3.521994576609375*^9, 3.521994577125*^9}, 3.522069407859375*^9, {
   3.52302817175*^9, 3.52302817784375*^9}, {3.52302821046875*^9, 
   3.523028219296875*^9}, {3.52302827453125*^9, 3.523028289421875*^9}, {
   3.52303357528125*^9, 3.523033624796875*^9}, {3.5232999903125*^9, 
   3.523300034796875*^9}, {3.52330072346875*^9, 3.52330075775*^9}, {
   3.5387617592355986`*^9, 3.538761759396615*^9}, {3.5387617916248374`*^9, 
   3.5387617925049257`*^9}, {3.543074082165307*^9, 3.543074148335307*^9}, {
   3.543074210203307*^9, 3.5430743652183065`*^9}, {3.543074567731307*^9, 
   3.543074573234307*^9}, {3.5559323940156097`*^9, 3.5559323943316097`*^9}, {
   3.607439625669918*^9, 3.6074396543680487`*^9}, {3.607439867479303*^9, 
   3.607439869055303*^9}, 3.607439915804303*^9, 3.607511164047207*^9, {
   3.607514050238797*^9, 3.607514079531726*^9}, {3.6075142174375153`*^9, 
   3.6075142277115426`*^9}, {3.762007337943627*^9, 3.7620073918638363`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"09c58d84-308d-4da3-b13b-24545a487af0"],

Cell["Define body Jacobians for calculating inertia matrix:", "Text",
 CellChangeTimes->{{3.6075111782266245`*^9, 3.6075111912639284`*^9}, 
   3.6075112223800397`*^9, {3.6075115393857365`*^9, 
   3.6075115557943773`*^9}},ExpressionUUID->"2b7f96b9-9192-4153-9d47-\
c5cfe1a5878d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"J0", " ", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", " ", "gst00"}], "]"}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J1", " ", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", " ", "gst01"}], "]"}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J2", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax4", ",", 
        RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", "gst02"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J3", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax4", ",", 
        RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax5", ",", 
        RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", " ", "gst03"}], "]"}], "//",
     "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5111738617903476`*^9, 3.5111738667576323`*^9}, {
  3.520687517765625*^9, 3.520687540921875*^9}, {3.520687606828125*^9, 
  3.5206876815*^9}, {3.520687776859375*^9, 3.520687825828125*^9}, {
  3.5207672543125*^9, 3.52076725465625*^9}, {3.520857785640625*^9, 
  3.520857819140625*^9}, {3.521820049171875*^9, 3.5218200495*^9}, {
  3.521820085109375*^9, 3.521820108265625*^9}, {3.52191142990625*^9, 
  3.521911483640625*^9}, {3.52199456603125*^9, 3.52199457315625*^9}, {
  3.52302830015625*^9, 3.523028386578125*^9}, {3.523300027125*^9, 
  3.523300057609375*^9}, {3.5430744013273067`*^9, 3.543074418830307*^9}, {
  3.543074460187307*^9, 3.543074460955307*^9}, {3.543074502201307*^9, 
  3.543074505464307*^9}, {3.543074580212307*^9, 3.5430745997753067`*^9}, {
  3.5559323895946093`*^9, 3.555932390122609*^9}, {3.60751408777355*^9, 
  3.6075141260873814`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"0bf780b2-f467-4ded-ab3d-0763f93a0f7d"],

Cell["Define mass/inertia tensor for caculating inertia matrix:", "Text",
 CellChangeTimes->{{3.6075112115199537`*^9, 3.6075112223800397`*^9}, {
  3.6075115456003585`*^9, 
  3.6075115529810963`*^9}},ExpressionUUID->"d5f13261-238c-48bc-8294-\
afad1f91d735"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genM0", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Mh", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Mh", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", " ", "Mh", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM1", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Mt", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Mt", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", " ", "Mt", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "Itx", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Ity", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Itz"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM2", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Ms", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Ms", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", " ", "Ms", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "Isx", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Isy", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Isz"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Mf", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Mf", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", " ", "Mf", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.433012010505102*^9, 3.433012038358485*^9}, {
  3.436353576828125*^9, 3.436353582609375*^9}, {3.52068788865625*^9, 
  3.520687977125*^9}, {3.52085784484375*^9, 3.520857845265625*^9}, {
  3.52182011409375*^9, 3.521820117296875*^9}, {3.521994584796875*^9, 
  3.521994585109375*^9}, {3.521994813015625*^9, 3.5219948365*^9}, {
  3.523028390890625*^9, 3.52302848009375*^9}, {3.523300063953125*^9, 
  3.523300074703125*^9}, {3.543074793253307*^9, 3.5430748479073067`*^9}, {
  3.555932384443609*^9, 3.5559323849556093`*^9}, {3.6074396927142134`*^9, 
  3.607439748297654*^9}, {3.607440150263303*^9, 3.607440162061303*^9}, {
  3.6075142487336445`*^9, 3.607514272100981*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"c805ecbe-7e99-485f-ae3d-18ca90f78806"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamics", "Section",
 CellChangeTimes->{{3.521995144125*^9, 3.521995144875*^9}, {
   3.526060014172608*^9, 3.5260600152917194`*^9}, {3.543078143146307*^9, 
   3.543078144569307*^9}, 
   3.5431473723201914`*^9},ExpressionUUID->"46dbeff6-4aaf-4bf6-966b-\
68fec2e04ab5"],

Cell[CellGroupData[{

Cell["Kinetic Terms", "Subsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 
   3.520790985625*^9}},ExpressionUUID->"897df12e-ecbb-4fa5-a6f0-fd1ece177463"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Mmatrix", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "J0", "]"}], ".", "genM0", ".", "J0"}], "+", 
     RowBox[{
      RowBox[{"Transpose", "[", "J1", "]"}], ".", "genM1", ".", "J1"}], "+", 
     RowBox[{
      RowBox[{"Transpose", "[", "J2", "]"}], ".", "genM2", ".", "J2"}], "+", 
     RowBox[{
      RowBox[{"Transpose", "[", "J3", "]"}], ".", "genM3", ".", "J3"}]}]}], 
   "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.436353597484375*^9, 3.43635360178125*^9}, {
   3.506260829855875*^9, 3.506260830262125*^9}, 3.520857879921875*^9, {
   3.52182012359375*^9, 3.52182012378125*^9}, 3.521911505546875*^9, {
   3.521912109421875*^9, 3.521912109921875*^9}, 3.521994592015625*^9, {
   3.523028493390625*^9, 3.523028504609375*^9}, {3.523300081109375*^9, 
   3.523300086140625*^9}, {3.543074855422307*^9, 3.543074855934307*^9}, {
   3.6075142901767883`*^9, 3.607514296443415*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"8e815115-d861-4f2b-aa89-b60a4a16c0ef"],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"BodyJacobian", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
      "]"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Mh", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "Mh", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Mh", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], "}"}], ".", 
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
     "]"}]}], "+", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"BodyJacobian", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", 
           RowBox[{"-", 
            FractionBox["lt", "2"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
      "]"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Mt", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "Mt", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Mt", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "Itx", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Ity", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Itz"}], 
       "}"}]}], "}"}], ".", 
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", 
          RowBox[{"-", 
           FractionBox["lt", "2"]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
     "]"}]}], "+", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"BodyJacobian", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "lt"}], ",", "0", ",", "1", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["ls", "2"]}], "-", "lt"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
      "]"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ms", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "Ms", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Ms", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "Isx", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Isy", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Isz"}], 
       "}"}]}], "}"}], ".", 
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "lt"}], ",", "0", ",", "1", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["ls", "2"]}], "-", "lt"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
     "]"}]}], "+", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"BodyJacobian", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "lt"}], ",", "0", ",", "1", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "ls"}], "-", "lt"}], ",", "0", ",", "1", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", 
            FractionBox["lf", "2"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", 
           RowBox[{
            RowBox[{"-", "ls"}], "-", "lt"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
      "]"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Mf", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "Mf", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Mf", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], "}"}], ".", 
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "lt"}], ",", "0", ",", "1", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"q4", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "ls"}], "-", "lt"}], ",", "0", ",", "1", ",", "0", 
          ",", "0"}], "}"}], ",", 
        RowBox[{"q5", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", 
           FractionBox["lf", "2"]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", 
          RowBox[{
           RowBox[{"-", "ls"}], "-", "lt"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
     "]"}]}]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7620074070237265`*^9, 3.7620074462234616`*^9, 
  3.7620075943335547`*^9, 3.7898377465607805`*^9},
 CellLabel->
  "Out[32]//MatrixForm=",ExpressionUUID->"6dff61af-d7ba-4083-be6c-\
4c35fb02e8f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cmtx", "=", 
   RowBox[{"0", "*", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"First", "[", 
      RowBox[{"Dimensions", "[", "q", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"First", "[", 
      RowBox[{"Dimensions", "[", "q", "]"}], "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", 
       RowBox[{"First", "[", 
        RowBox[{"Dimensions", "[", "q", "]"}], "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Cmtx", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FullSimplify", "[", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Mmatrix", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "t"}], "]"}], 
           "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FullSimplify", "[", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"Mmatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                  RowBox[{"q", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
               "-", 
               RowBox[{"FullSimplify", "[", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"Mmatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
                  RowBox[{"q", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
              ")"}], " ", 
             RowBox[{"qdot", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"First", "[", 
               RowBox[{"Dimensions", "[", "q", "]"}], "]"}]}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Cmtx", " ", "=", " ", 
  RowBox[{"Cmtx", "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.520791335*^9, 3.520791401109375*^9}, {
  3.520791435046875*^9, 3.52079155540625*^9}, {3.520791602453125*^9, 
  3.520791651296875*^9}, {3.5207916853125*^9, 3.520791710046875*^9}, {
  3.520857930671875*^9, 3.520857946375*^9}, {3.521820137609375*^9, 
  3.52182014315625*^9}, {3.52189796709375*^9, 3.521898017515625*^9}, {
  3.523028605546875*^9, 3.52302860590625*^9}, {3.523380346921875*^9, 
  3.52338035309375*^9}, {3.607440461414303*^9, 
  3.607440491351303*^9}},ExpressionUUID->"b083987f-41d9-42a6-bf95-\
927926a0defb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lf", " ", "Mf", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"lt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"Mf", "+", "Ms"}], ")"}]}], "+", "Mt"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"q3", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"ls", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lf", " ", "Mf", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"ls", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"lf", " ", "Mf", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"q3", "[", "t", "]"}], "+", 
           RowBox[{"q4", "[", "t", "]"}], "+", 
           RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lf", " ", "Mf", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"ls", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["q3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["q4", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
        RowBox[{"lf", " ", "Mf", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"q3", "[", "t", "]"}], "+", 
           RowBox[{"q4", "[", "t", "]"}], "+", 
           RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", "lf", " ", "Mf", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q3", "[", "t", "]"}], "+", 
        RowBox[{"q4", "[", "t", "]"}], "+", 
        RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q3", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q4", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q5", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"Mf", "+", "Ms"}], ")"}]}], "+", "Mt"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"q3", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"ls", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"lf", " ", "Mf", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ls", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"lf", " ", "Mf", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"lf", " ", "Mf", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q3", "[", "t", "]"}], "+", 
           RowBox[{"q4", "[", "t", "]"}], "+", 
           RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ls", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"lf", " ", "Mf", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q3", "[", "t", "]"}], "+", 
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["q3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["q4", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
        RowBox[{"lf", " ", "Mf", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q3", "[", "t", "]"}], "+", 
           RowBox[{"q4", "[", "t", "]"}], "+", 
           RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", "lf", " ", "Mf", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q3", "[", "t", "]"}], "+", 
        RowBox[{"q4", "[", "t", "]"}], "+", 
        RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q3", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q4", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q5", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lf", " ", "Mf", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"ls", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"q4", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"lf", " ", "Mf", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"q5", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lf", " ", "Mf", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"ls", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"q4", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["q3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["q4", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
        RowBox[{"lf", " ", "Mf", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"q5", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", "lf", " ", "Mf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ls", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"q5", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"lt", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"q4", "[", "t", "]"}], "+", 
           RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q3", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q4", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q5", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "lf"}], " ", "Mf", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"ls", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"q4", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"lf", " ", "ls", " ", "Mf", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"q5", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", "lf", " ", "ls", " ", "Mf", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"q5", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["q5", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", "lf", " ", "ls", " ", "Mf", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"q5", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q3", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q4", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q5", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "lf", " ", "Mf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"q5", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"q4", "[", "t", "]"}], "+", 
              RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"ls", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"q5", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "lf", " ", "ls", " ", "Mf", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"q5", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q3", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q4", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], ",", "0"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.555327477859934*^9, 3.588002819694274*^9, {3.607439972128303*^9, 
   3.6074399800603027`*^9}, 3.607440172307303*^9, 3.607440499546303*^9, 
   3.6075118204118366`*^9, 3.6075143040491753`*^9, 3.6075154482245817`*^9, 
   3.6075155712418823`*^9, 
   3.7620076612137313`*^9},ExpressionUUID->"53fa24fd-4954-4a7a-a685-\
2d7229ed5ec6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Potential Terms", "Subsection",
 CellChangeTimes->{
  3.52079098003125*^9},ExpressionUUID->"8fb65fb5-83cd-42f1-ab32-3b6b13d9e63a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pH", " ", "=", 
  RowBox[{"Take", "[", 
   RowBox[{"gst00", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", "4", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pT", " ", "=", 
  RowBox[{"Take", "[", 
   RowBox[{"gst01", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", "4", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pS", "=", 
  RowBox[{"Take", "[", 
   RowBox[{"gst02", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", "4", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pF", "=", 
  RowBox[{"Take", "[", 
   RowBox[{"gst03", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", "4", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.43635384953125*^9, 3.436353929328125*^9}, {
   3.43636674765625*^9, 3.436366754546875*^9}, 3.520766712796875*^9, {
   3.52076683184375*^9, 3.520767059859375*^9}, {3.520767139453125*^9, 
   3.520767177578125*^9}, {3.52302867446875*^9, 3.52302869521875*^9}, {
   3.5431470943241916`*^9, 3.5431471243701916`*^9}, {3.5870538268538475`*^9, 
   3.587053827821944*^9}, {3.607439996020303*^9, 3.607439999325303*^9}, {
   3.607440516443303*^9, 3.607440520947303*^9}, {3.6075143150912795`*^9, 
   3.60751433189496*^9}, {3.7620078229776464`*^9, 
   3.7620078241779003`*^9}},ExpressionUUID->"206e1e33-a298-4507-a4c3-\
6d581b5117dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.762007824787221*^9},ExpressionUUID->"82e5c28f-91c2-4534-916f-\
cc1292d5167b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"-", 
     FractionBox["lt", "2"]}], "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.762007824793248*^9},ExpressionUUID->"3950ec9a-b60d-489b-bdd8-\
2d442e9aadf1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["ls", "2"]}], "-", "lt"}], "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.762007824805267*^9},ExpressionUUID->"04888ee8-1676-4555-a433-\
dcb57cc4482a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"-", 
     FractionBox["lf", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "ls"}], "-", "lt"}], "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.762007824810317*^9},ExpressionUUID->"291cf37e-a445-4d03-a653-\
30d0944616e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"pHp", " ", "=", " ", 
   RowBox[{
    RowBox[{"e1", ".", "e2", ".", "pH"}], "//", "FullSimplify"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"pTp", " ", "=", " ", 
   RowBox[{
    RowBox[{"e1", ".", "e2", ".", "e3", ".", "pT"}], "//", "FullSimplify"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"pSp", " ", "=", " ", 
   RowBox[{
    RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "pS"}], "//", 
    "FullSimplify"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"pFp", " ", "=", " ", 
   RowBox[{
    RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "e5", ".", "pF"}], "//",
     "FullSimplify"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.43635395903125*^9, 3.43635397253125*^9}, {
  3.520767215140625*^9, 3.52076722809375*^9}, {3.520767277078125*^9, 
  3.52076737496875*^9}, {3.523028701984375*^9, 3.523028714265625*^9}, {
  3.5230287605*^9, 3.523028792140625*^9}, {3.5431471447521915`*^9, 
  3.5431471594071913`*^9}, {3.607440009292303*^9, 3.607440014899303*^9}, {
  3.607440523195303*^9, 3.607440527098303*^9}, {3.607514337989569*^9, 
  3.607514344558226*^9}},ExpressionUUID->"1ce68ad9-900d-4d87-819f-\
ca0ca94ba1f9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {
      RowBox[{"q1", "[", "t", "]"}]},
     {
      RowBox[{"q2", "[", "t", "]"}]},
     {"1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.520767378109375*^9, 3.523028792921875*^9, 
  3.52329677090625*^9, 3.5233010796875*^9, 3.52336047896875*^9, 
  3.523360829546875*^9, 3.52338021825*^9, 3.5233804499375*^9, 
  3.525438127684517*^9, 3.525447410642517*^9, 3.525524650880395*^9, 
  3.526040650145399*^9, 3.5260600236005507`*^9, 3.5261430712394705`*^9, 
  3.5262124442641616`*^9, 3.538740806275141*^9, 3.538767169540083*^9, 
  3.539014862332183*^9, 3.539015167809727*^9, 3.5431471597321916`*^9, 
  3.5550913731940184`*^9, 3.607440016914303*^9, 3.6074401726113033`*^9, 
  3.607511822670062*^9, 3.60751434769954*^9, 3.6075154482645855`*^9, 
  3.6075155712708855`*^9, 
  3.7620076645971527`*^9},ExpressionUUID->"e3d5c08f-9ee4-464b-9a32-\
2de88ad75e13"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {
      RowBox[{
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "lt", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q3", "[", "t", "]"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", "lt", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}]},
     {"1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.520767378109375*^9, 3.523028792921875*^9, 
  3.52329677090625*^9, 3.5233010796875*^9, 3.52336047896875*^9, 
  3.523360829546875*^9, 3.52338021825*^9, 3.5233804499375*^9, 
  3.525438127684517*^9, 3.525447410642517*^9, 3.525524650880395*^9, 
  3.526040650145399*^9, 3.5260600236005507`*^9, 3.5261430712394705`*^9, 
  3.5262124442641616`*^9, 3.538740806275141*^9, 3.538767169540083*^9, 
  3.539014862332183*^9, 3.539015167809727*^9, 3.5431471597321916`*^9, 
  3.5550913731940184`*^9, 3.607440016914303*^9, 3.6074401726113033`*^9, 
  3.607511822670062*^9, 3.60751434769954*^9, 3.6075154482645855`*^9, 
  3.6075155712708855`*^9, 
  3.7620076646163597`*^9},ExpressionUUID->"755655f5-8a2f-4ae3-8492-\
3fcf34e9f4e1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {
      RowBox[{
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"lt", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "ls", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "lt"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q3", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", "ls", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}]},
     {"1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.520767378109375*^9, 3.523028792921875*^9, 
  3.52329677090625*^9, 3.5233010796875*^9, 3.52336047896875*^9, 
  3.523360829546875*^9, 3.52338021825*^9, 3.5233804499375*^9, 
  3.525438127684517*^9, 3.525447410642517*^9, 3.525524650880395*^9, 
  3.526040650145399*^9, 3.5260600236005507`*^9, 3.5261430712394705`*^9, 
  3.5262124442641616`*^9, 3.538740806275141*^9, 3.538767169540083*^9, 
  3.539014862332183*^9, 3.539015167809727*^9, 3.5431471597321916`*^9, 
  3.5550913731940184`*^9, 3.607440016914303*^9, 3.6074401726113033`*^9, 
  3.607511822670062*^9, 3.60751434769954*^9, 3.6075154482645855`*^9, 
  3.6075155712708855`*^9, 
  3.762007664703844*^9},ExpressionUUID->"7c51481e-a7b8-484d-b2e1-\
b4165b58249e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", "lf", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}], "+", 
          RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"lt", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "lt"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q3", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"ls", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"q2", "[", "t", "]"}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", "lf", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}], "+", 
          RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}]},
     {"1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.520767378109375*^9, 3.523028792921875*^9, 
  3.52329677090625*^9, 3.5233010796875*^9, 3.52336047896875*^9, 
  3.523360829546875*^9, 3.52338021825*^9, 3.5233804499375*^9, 
  3.525438127684517*^9, 3.525447410642517*^9, 3.525524650880395*^9, 
  3.526040650145399*^9, 3.5260600236005507`*^9, 3.5261430712394705`*^9, 
  3.5262124442641616`*^9, 3.538740806275141*^9, 3.538767169540083*^9, 
  3.539014862332183*^9, 3.539015167809727*^9, 3.5431471597321916`*^9, 
  3.5550913731940184`*^9, 3.607440016914303*^9, 3.6074401726113033`*^9, 
  3.607511822670062*^9, 3.60751434769954*^9, 3.6075154482645855`*^9, 
  3.6075155712708855`*^9, 
  3.7620076649339027`*^9},ExpressionUUID->"636aa04e-3b18-4f1d-ad7f-\
6bebdc740680"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PE", " ", "=", " ", 
  RowBox[{
   RowBox[{"First", "[", 
    RowBox[{
     RowBox[{"Mf", "*", "g", "*", 
      RowBox[{"pFp", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "+", 
     RowBox[{"Ms", "*", "g", "*", 
      RowBox[{"pSp", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "+", 
     RowBox[{"Mt", "*", "g", "*", 
      RowBox[{"pTp", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "+", 
     RowBox[{"Mh", "*", "g", "*", 
      RowBox[{"pHp", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.436353983078125*^9, 3.436353991234375*^9}, {
   3.436354181125*^9, 3.43635418390625*^9}, 3.5090404416343727`*^9, {
   3.509539414111295*^9, 3.509539527743894*^9}, 3.509539567648764*^9, {
   3.5095401253128805`*^9, 3.5095401303828897`*^9}, {3.5095401706491876`*^9, 
   3.5095401776848*^9}, {3.520767514421875*^9, 3.520767516734375*^9}, {
   3.520767582609375*^9, 3.520767645375*^9}, {3.5207676989375*^9, 
   3.520767715578125*^9}, {3.5230288115*^9, 3.52302884490625*^9}, {
   3.5431472111331916`*^9, 3.5431472276271915`*^9}, {3.607440082919303*^9, 
   3.607440086123303*^9}, {3.607440172591303*^9, 3.607440174793303*^9}, {
   3.6075143642101912`*^9, 3.60751436779955*^9}, {3.6075156369604535`*^9, 
   3.607515640064764*^9}},ExpressionUUID->"2ad16c02-3a06-407e-aff4-\
e563bd32e9b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", "g", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"lt", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"Mf", "+", "Ms"}], ")"}]}], "+", "Mt"}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q3", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"ls", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"q3", "[", "t", "]"}], "+", 
       RowBox[{"q4", "[", "t", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"Mf", "+", "Mh", "+", "Ms", "+", "Mt"}], ")"}], " ", 
     RowBox[{"q2", "[", "t", "]"}]}], "+", 
    RowBox[{"lf", " ", "Mf", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"q3", "[", "t", "]"}], "+", 
       RowBox[{"q4", "[", "t", "]"}], "+", 
       RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.509041002421875*^9, 3.5095395639827576`*^9, 3.509539671016144*^9, 
   3.509540448741289*^9, 3.520767648515625*^9, 3.52076773053125*^9, {
   3.5230288378125*^9, 3.523028846078125*^9}, 3.52330108371875*^9, 
   3.523360480703125*^9, 3.52336083128125*^9, 3.5233802205*^9, 
   3.52338045165625*^9, 3.5254381300395174`*^9, 3.5254474155545173`*^9, 
   3.525524652841395*^9, 3.5260406512655106`*^9, 3.526060024736664*^9, 
   3.526143072364583*^9, 3.5262124453991613`*^9, 3.538740807747141*^9, 
   3.538767172246083*^9, 3.5390148717231216`*^9, 3.5390151718921356`*^9, 
   3.5431472284171915`*^9, 3.555091378692568*^9, 3.607440087613303*^9, 
   3.607440175969303*^9, 3.607511828933689*^9, 3.6075143709288626`*^9, 
   3.607515449625722*^9, 3.607515572650023*^9, 
   3.7620077349334736`*^9},ExpressionUUID->"9cff95b6-0986-4dc0-8ea4-\
4e1886d71742"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Gvect", " ", "=", " ", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"D", "[", 
      RowBox[{"PE", ",", 
       RowBox[{"Transpose", "[", "q", "]"}]}], "]"}], "}"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.52079087128125*^9, 3.52079093284375*^9}, {
  3.52079096634375*^9, 3.52079096821875*^9}, {3.5230288525625*^9, 
  3.523028852640625*^9}, {3.523030197421875*^9, 3.523030201796875*^9}, {
  3.607440093174303*^9, 
  3.607440093405303*^9}},ExpressionUUID->"83c6ce52-5925-42f6-bd78-\
5d5eeffebfad"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"g", " ", 
     RowBox[{"(", 
      RowBox[{"Mf", "+", "Mh", "+", "Ms", "+", "Mt"}], ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], " ", "g", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "lf"}], " ", "Mf", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}], "+", 
          RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"lt", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"Mf", "+", "Ms"}], ")"}]}], "+", "Mt"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], " ", "g", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "lf"}], " ", "Mf", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}], "+", 
          RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", "g", " ", "lf", " ", "Mf", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"q3", "[", "t", "]"}], "+", 
       RowBox[{"q4", "[", "t", "]"}], "+", 
       RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.762007746004171*^9},ExpressionUUID->"5e2d6139-7e90-4823-9618-\
85f9814e271d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"g", " ", 
      RowBox[{"(", 
       RowBox[{"Mf", "+", "Mh", "+", "Ms", "+", "Mt"}], ")"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "2"], " ", "g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "lf"}], " ", "Mf", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"q3", "[", "t", "]"}], "+", 
           RowBox[{"q4", "[", "t", "]"}], "+", 
           RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "+", 
        RowBox[{"lt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"Mf", "+", "Ms"}], ")"}]}], "+", "Mt"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"q3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"ls", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q3", "[", "t", "]"}], "+", 
           RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "2"], " ", "g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "lf"}], " ", "Mf", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"q3", "[", "t", "]"}], "+", 
           RowBox[{"q4", "[", "t", "]"}], "+", 
           RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "+", 
        RowBox[{"ls", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q3", "[", "t", "]"}], "+", 
           RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "g", " ", "lf", " ", "Mf", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q3", "[", "t", "]"}], "+", 
        RowBox[{"q4", "[", "t", "]"}], "+", 
        RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.762007744403077*^9, 
  3.76200774442377*^9}},ExpressionUUID->"440f03df-ec82-4577-b882-\
66e920651f95"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinematic Constraints", "Subsection",
 CellChangeTimes->{{3.607440537966303*^9, 
  3.607440544936303*^9}},ExpressionUUID->"54f47daa-68a4-4021-90e0-\
2e2aaf66a9d8"],

Cell[CellGroupData[{

Cell["Constraint for swing phase (constraining hip coordinates)", \
"Subsubsection",
 CellChangeTimes->{{3.6074407709562216`*^9, 3.6074407855226784`*^9}, {
  3.6075137909198675`*^9, 3.6075138126480403`*^9}, {3.607513923124087*^9, 
  3.607513924543229*^9}, {3.60751443810458*^9, 3.60751444690746*^9}, {
  3.6075145602367916`*^9, 
  3.607514561897958*^9}},ExpressionUUID->"7ba0bf3e-35de-45b1-bf44-\
0f1f4796edcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aHip", "[", "q1_", "]"}], ":=", "q1"}]], "Input",
 CellChangeTimes->{{3.607440793159442*^9, 3.6074407964777737`*^9}, {
  3.607440835576683*^9, 3.6074408532944546`*^9}, {3.6074409243065553`*^9, 
  3.6074409277529*^9}, {3.6074409635154753`*^9, 3.607440964626587*^9}, {
  3.607514578269595*^9, 
  3.6075145797407417`*^9}},ExpressionUUID->"23228031-a260-4b65-b6dc-\
34b1ff9ba92c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ahip", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"aHip", "[", 
        RowBox[{"q1", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"aHip", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Transpose", "[", "q", "]"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.607440677401867*^9, 3.6074406987159986`*^9}, {
   3.607440863841509*^9, 3.607440880328158*^9}, {3.607440930915216*^9, 
   3.6074409359787226`*^9}, 3.6074409672358475`*^9, {3.6075139417829523`*^9, 
   3.607513944796254*^9}, 3.6075140320889826`*^9, {3.6075145705058184`*^9, 
   3.607514572787047*^9}},ExpressionUUID->"a5372430-abc8-4b72-b9c8-\
dfaba981d87e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.607440699403067*^9, 3.6074407068598127`*^9}, {
   3.6074408768208075`*^9, 3.607440880697195*^9}, 3.6074409368398085`*^9, 
   3.60744096855898*^9, 3.6075118331301084`*^9, 3.607513945707345*^9, 
   3.6075140333171053`*^9, 3.607514401175887*^9, {3.6075145750782757`*^9, 
   3.6075145810548735`*^9}, 3.6075154501807775`*^9, 3.607515573198078*^9, 
   3.7620077880242395`*^9},ExpressionUUID->"25e96763-5d16-447f-9c24-\
24babcd9d5f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ahipdot", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"Ahip", ",", "t"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6074408826163864`*^9, 
  3.607440885728698*^9}},ExpressionUUID->"26f024bb-81bf-42e2-b9f4-\
b3df608a5773"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6074407116772947`*^9, 3.6074408859787226`*^9, 
  3.6074409377498994`*^9, 3.607440972348359*^9, 3.6075118342822237`*^9, 
  3.607513947796554*^9, 3.6075140344222155`*^9, 3.6075144022479944`*^9, 
  3.6075145823740053`*^9, 3.607515450195779*^9, 3.6075155732130795`*^9, 
  3.7620077892980895`*^9},ExpressionUUID->"ada59923-1092-4024-b2bc-\
f3e008b47069"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"LambdaHip", " ", "=", " ", 
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{"Ahip", ".", "Mmatrix", ".", 
     RowBox[{"Transpose", "[", "Ahip", "]"}]}], "]"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ahipdot", ".", "qdot"}], " ", "-", 
     RowBox[{"Ahip", ".", 
      RowBox[{"Inverse", "[", "Mmatrix", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cmtx", ".", "qdot"}], "+", "Gvect", "-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "u_hip", "}"}], ",", 
          RowBox[{"{", "u_knee", "}"}], ",", 
          RowBox[{"{", "u_ankle", "}"}]}], "}"}]}], ")"}]}]}], 
    ")"}]}]}]], "DisplayFormula",
 CellChangeTimes->{{3.6075131383576183`*^9, 3.6075131401217947`*^9}, {
  3.607513215956377*^9, 3.6075133331900997`*^9}, {3.607513558346613*^9, 
  3.6075135793837166`*^9}},ExpressionUUID->"b9abbf0d-1d2e-487b-be4d-\
702e52680c1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constraint for stance phase (constraining toe coordinates)", \
"Subsubsection",
 CellChangeTimes->{{3.6074407709562216`*^9, 3.6074407879149175`*^9}, {
   3.607513816526428*^9, 3.607513822462022*^9}, {3.6075139280445786`*^9, 
   3.607513929780752*^9}, {3.6075144491326823`*^9, 3.607514456329402*^9}, 
   3.6075145649482627`*^9},ExpressionUUID->"17e7cbbd-b7d7-4806-90f5-\
67a5e48d0b5b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pToe", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", "lf"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "ls"}], "-", "lt"}], "}"}], ",", 
     RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"pToep", " ", "=", " ", 
   RowBox[{
    RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "e5", ".", "pToe"}], "//",
     "FullSimplify"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.43635384953125*^9, 3.436353929328125*^9}, {
   3.43636674765625*^9, 3.436366754546875*^9}, 3.520766712796875*^9, {
   3.52076683184375*^9, 3.520767059859375*^9}, {3.520767139453125*^9, 
   3.520767177578125*^9}, {3.52302867446875*^9, 3.52302869521875*^9}, {
   3.5431470943241916`*^9, 3.5431471243701916`*^9}, {3.5870538268538475`*^9, 
   3.587053827821944*^9}, {3.607439996020303*^9, 3.607439999325303*^9}, {
   3.6074402854093027`*^9, 3.607440310056303*^9}, {3.607440559479303*^9, 
   3.607440559792303*^9}, {3.7620078321002555`*^9, 
   3.762007850893529*^9}},ExpressionUUID->"0b730f7e-590a-480a-94d5-\
22ef7dea11bc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "lf"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}], "+", 
          RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"lt", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "lt"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q3", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"ls", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"q2", "[", "t", "]"}], "-", 
       RowBox[{"lf", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q3", "[", "t", "]"}], "+", 
          RowBox[{"q4", "[", "t", "]"}], "+", 
          RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}]},
     {"1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.607440323948303*^9, 3.607440327863303*^9}, 
   3.60751183674247*^9, 3.6075144618329525`*^9, 3.6075154503767967`*^9, 
   3.607515573391097*^9, 3.7620077954839644`*^9, {3.762007834143861*^9, 
   3.762007851673769*^9}},ExpressionUUID->"6597b8ba-b05c-4f6f-9340-\
fd4cbdd69a4e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aToe1", "[", 
   RowBox[{"q1_", ",", "q2_", ",", "q3_", ",", "q4_", ",", "q5_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "lf"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"q3", "+", "q4", "+", "q5"}], "]"}]}], "+", "q1", "+", 
   RowBox[{"lt", " ", 
    RowBox[{"Sin", "[", "q3", "]"}]}], "+", 
   RowBox[{"ls", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"q3", "+", "q4"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aToe2", "[", 
   RowBox[{"q1_", ",", "q2_", ",", "q3_", ",", "q4_", ",", "q5_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "lt"}], " ", 
    RowBox[{"Cos", "[", "q3", "]"}]}], "-", 
   RowBox[{"ls", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"q3", "+", "q4"}], "]"}]}], "+", "q2", "-", 
   RowBox[{"lf", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"q3", "+", "q4", "+", "q5"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.607440573358303*^9, 3.607440642194303*^9}, {
   3.6074407044105678`*^9, 3.6074407045585823`*^9}, 
   3.762007896613669*^9},ExpressionUUID->"085f44fd-2de0-455d-8843-\
54c8d3d272d8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Atoe", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"aToe1", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], ",", 
         RowBox[{"q2", "[", "t", "]"}], ",", 
         RowBox[{"q3", "[", "t", "]"}], ",", 
         RowBox[{"q4", "[", "t", "]"}], ",", 
         RowBox[{"q5", "[", "t", "]"}]}], "]"}], ",", 
       RowBox[{"aToe2", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], ",", 
         RowBox[{"q2", "[", "t", "]"}], ",", 
         RowBox[{"q3", "[", "t", "]"}], ",", 
         RowBox[{"q4", "[", "t", "]"}], ",", 
         RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"Transpose", "[", "q", "]"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.607440677401867*^9, 3.6074406987159986`*^9}, {
   3.607440888143939*^9, 3.607440890131138*^9}, {3.607512655079295*^9, 
   3.607512670540841*^9}, 
   3.607514430915861*^9},ExpressionUUID->"1252b5fc-765c-4be1-b5ff-\
acb0182bd784"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", 
     RowBox[{
      RowBox[{"lt", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q3", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"ls", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"lf", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}], "+", 
         RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"ls", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"lf", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}], "+", 
         RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"lf", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q3", "[", "t", "]"}], "+", 
        RowBox[{"q4", "[", "t", "]"}], "+", 
        RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "lf"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}], "+", 
         RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"lt", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q3", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"ls", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "lf"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}], "+", 
         RowBox[{"q5", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"ls", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}]}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"-", "lf"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q3", "[", "t", "]"}], "+", 
        RowBox[{"q4", "[", "t", "]"}], "+", 
        RowBox[{"q5", "[", "t", "]"}]}], "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.607440699403067*^9, 3.6074407068598127`*^9}, 
   3.6074408923443594`*^9, 3.6075118399027853`*^9, 3.6075126717709637`*^9, 
   3.6075144645412235`*^9, 3.6075154504648056`*^9, 3.6075155734771056`*^9, 
   3.762007902563742*^9},ExpressionUUID->"56adfdbc-a8ad-48d7-a603-\
bc92da7bccf1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Atoedot", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"Atoe", ",", "t"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6074408938645115`*^9, 
  3.607440896281753*^9}},ExpressionUUID->"3e888c53-af4e-4f8f-a2f9-\
ef661b2107d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "lt"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q3", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["q3", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "-", 
      RowBox[{"ls", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{"lf", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}], "+", 
         RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "ls"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{"lf", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}], "+", 
         RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ",", 
     RowBox[{"lf", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q3", "[", "t", "]"}], "+", 
        RowBox[{"q4", "[", "t", "]"}], "+", 
        RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q3", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q4", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q5", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"lt", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q3", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["q3", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{"ls", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{"lf", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}], "+", 
         RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"ls", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{"lf", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q3", "[", "t", "]"}], "+", 
         RowBox[{"q4", "[", "t", "]"}], "+", 
         RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ",", 
     RowBox[{"lf", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q3", "[", "t", "]"}], "+", 
        RowBox[{"q4", "[", "t", "]"}], "+", 
        RowBox[{"q5", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q3", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q4", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q5", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6074407116772947`*^9, 3.607440896599785*^9, 
  3.607511841986994*^9, 3.607512677498537*^9, 3.607514466792448*^9, 
  3.6075154512518845`*^9, 3.6075155742611837`*^9, 
  3.762007904373917*^9},ExpressionUUID->"050b8889-9825-4d22-a0dc-\
f988317308f3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"LambdaToe", " ", "=", " ", 
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{"Atoe", ".", "Mmatrix", ".", 
     RowBox[{"Transpose", "[", "Atoe", "]"}]}], "]"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Atoedot", ".", "qdot"}], " ", "-", 
     RowBox[{"Atoe", ".", 
      RowBox[{"Inverse", "[", "Mmatrix", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cmtx", ".", "qdot"}], "+", "Gvect", "-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "u_hip", "}"}], ",", 
          RowBox[{"{", "u_knee", "}"}], ",", 
          RowBox[{"{", "u_ankle", "}"}]}], "}"}]}], ")"}]}]}], 
    ")"}]}]}]], "DisplayFormula",
 CellChangeTimes->{{3.6075131383576183`*^9, 3.6075131401217947`*^9}, {
  3.607513215956377*^9, 3.6075133331900997`*^9}, {3.6075136093067083`*^9, 
  3.607513609674745*^9}},ExpressionUUID->"7dd37ece-0e80-4a9c-b76a-\
dbbc2bef0540"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations of Motion", "Subsection",
 CellChangeTimes->{{3.607440537966303*^9, 3.607440544936303*^9}, {
  3.607511794218218*^9, 
  3.607511796912487*^9}},ExpressionUUID->"a4dc4465-c7eb-43a8-8766-\
d322f53a37ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Mmatrix", ".", "qddot"}], "+", 
   RowBox[{"Cmtx", ".", "qdot"}], "+", "Gvect", " ", "+", 
   RowBox[{
    RowBox[{"Transpose", "[", "A", "]"}], ".", "Lambda"}]}], "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "u_hip", "}"}], ",", 
    RowBox[{"{", "u_knee", "}"}], ",", 
    RowBox[{"{", "u_ankle", "}"}]}], "}"}]}]], "DisplayFormula",
 CellChangeTimes->{{3.607511799783774*^9, 3.607511806524448*^9}, {
  3.607511844486244*^9, 3.6075119180886035`*^9}, {3.607512024044198*^9, 
  3.6075120346852617`*^9}, {3.6075125843562236`*^9, 3.607512623573145*^9}, {
  3.607512725410328*^9, 3.6075127312809143`*^9}, {3.6075130656643496`*^9, 
  3.6075130664154243`*^9}, {3.6075136553943167`*^9, 
  3.6075136565114284`*^9}},ExpressionUUID->"765cc099-cde3-460d-beb8-\
60ffcf655e98"],

Cell[BoxData[
 RowBox[{"qddot", " ", "=", " ", 
  RowBox[{
   RowBox[{"Inverse", "[", "Mmatrix", "]"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cmtx", ".", "qdot"}]}], "-", "Gvect", " ", "-", 
     RowBox[{
      RowBox[{"Transpose", "[", "A", "]"}], ".", "Lambda"}], "+", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "u_hip", "}"}], ",", 
       RowBox[{"{", "u_knee", "}"}], ",", 
       RowBox[{"{", "u_ankle", "}"}]}], "}"}]}], ")"}]}]}]], "DisplayFormula",
 CellChangeTimes->{{3.607511799783774*^9, 3.607511806524448*^9}, {
  3.607511844486244*^9, 3.6075119180886035`*^9}, {3.607512024044198*^9, 
  3.6075120346852617`*^9}, {3.6075125843562236`*^9, 3.607512623573145*^9}, {
  3.607512725410328*^9, 3.6075127312809143`*^9}, {3.607512930869871*^9, 
  3.6075129371565*^9}, {3.6075130611949024`*^9, 3.607513062509034*^9}, {
  3.6075136583716145`*^9, 
  3.6075136593637133`*^9}},ExpressionUUID->"e730f271-c4aa-4f92-b9a0-\
18dc7604b11b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 637},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification->1.100000023841858,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 465, 7, 107, "Title",ExpressionUUID->"1ba14af8-ef33-4b83-af27-7981690e089b"],
Cell[1035, 31, 644, 13, 83, "Subsubtitle",ExpressionUUID->"4d6f21f6-8f60-4283-9c4c-49db68be2bcb"],
Cell[CellGroupData[{
Cell[1704, 48, 243, 4, 73, "Section",ExpressionUUID->"7acdc1cf-3fe4-4b6b-87c0-d98ad0c0347e"],
Cell[CellGroupData[{
Cell[1972, 56, 918, 22, 77, "Input",ExpressionUUID->"d11a497a-cb1a-445d-a11d-597d3ea78c8b"],
Cell[2893, 80, 462, 11, 23, "Message",ExpressionUUID->"7cbfb2ea-8f5c-49f8-b97c-161ba59eacf1"],
Cell[3358, 93, 505, 12, 23, "Message",ExpressionUUID->"b977c9b5-2db2-4aa9-a479-5d6ce3363491"],
Cell[3866, 107, 475, 12, 23, "Message",ExpressionUUID->"c2a9f05c-609c-49f3-8d26-e08c6726368e"],
Cell[4344, 121, 496, 11, 23, "Message",ExpressionUUID->"162d50a1-aa5d-4ee7-ad13-4e2ece614206"]
}, Open  ]],
Cell[4855, 135, 250, 4, 39, "Text",ExpressionUUID->"32a41335-8637-4ad8-8472-732d463a5d57"],
Cell[5108, 141, 2760, 56, 99, "Input",ExpressionUUID->"ba51fb9f-64bb-4d53-8738-2ab842e6a8d9"],
Cell[7871, 199, 437, 9, 39, "Text",ExpressionUUID->"bfa488ed-49b2-482b-884b-897297ba69e7"],
Cell[CellGroupData[{
Cell[8333, 212, 3981, 86, 121, "Input",ExpressionUUID->"4b12a4d3-7eee-4754-8461-e3471f390e25"],
Cell[12317, 300, 312, 6, 36, "Output",ExpressionUUID->"f19c519a-88e6-4500-b104-9f9dbb11b55f"],
Cell[12632, 308, 329, 7, 36, "Output",ExpressionUUID->"6df52ef6-a40b-4d3a-9766-9aa6e4aa4f7c"],
Cell[12964, 317, 359, 8, 36, "Output",ExpressionUUID->"7f7cc41a-5664-4364-a2db-b476d226a763"]
}, Open  ]],
Cell[13338, 328, 301, 4, 39, "Text",ExpressionUUID->"a8947e5c-cd87-4207-8966-1f0393ae5736"],
Cell[CellGroupData[{
Cell[13664, 336, 1115, 27, 121, "Input",ExpressionUUID->"15f4ec07-f573-4943-b79e-ce5ada0e45c6"],
Cell[14782, 365, 798, 23, 107, "Output",ExpressionUUID->"9138f251-854f-4e11-adc6-fc68e0ae65ce"],
Cell[15583, 390, 798, 23, 107, "Output",ExpressionUUID->"4c57b98c-ee49-4411-9324-956c6c032051"],
Cell[16384, 415, 1063, 31, 107, "Output",ExpressionUUID->"f353f125-4471-4bee-83e3-b66b1f47315b"],
Cell[17450, 448, 1364, 41, 107, "Output",ExpressionUUID->"85e20213-ea53-4975-8c37-aec647ac2971"],
Cell[18817, 491, 1486, 45, 107, "Output",ExpressionUUID->"04844baf-b101-4286-bed7-ce4e685bdfb8"]
}, Open  ]],
Cell[20318, 539, 313, 5, 39, "Text",ExpressionUUID->"9aa40daf-cc6c-4049-a891-125ea0fb5b88"],
Cell[20634, 546, 4059, 99, 121, "Input",ExpressionUUID->"09c58d84-308d-4da3-b13b-24545a487af0"],
Cell[24696, 647, 278, 4, 39, "Text",ExpressionUUID->"2b7f96b9-9192-4153-9d47-c5cfe1a5878d"],
Cell[24977, 653, 4371, 116, 121, "Input",ExpressionUUID->"0bf780b2-f467-4ded-ab3d-0763f93a0f7d"],
Cell[29351, 771, 256, 4, 39, "Text",ExpressionUUID->"d5f13261-238c-48bc-8294-afad1f91d735"],
Cell[29610, 777, 3902, 99, 99, "Input",ExpressionUUID->"c805ecbe-7e99-485f-ae3d-18ca90f78806"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33549, 881, 274, 5, 73, "Section",ExpressionUUID->"46dbeff6-4aaf-4bf6-966b-68fec2e04ab5"],
Cell[CellGroupData[{
Cell[33848, 890, 227, 3, 59, "Subsection",ExpressionUUID->"897df12e-ecbb-4fa5-a6f0-fd1ece177463"],
Cell[CellGroupData[{
Cell[34100, 897, 1071, 21, 55, "Input",ExpressionUUID->"8e815115-d861-4f2b-aa89-b60a4a16c0ef"],
Cell[35174, 920, 16429, 467, 652, "Output",ExpressionUUID->"6dff61af-d7ba-4083-be6c-4c35fb02e8f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51640, 1392, 3178, 81, 209, "Input",ExpressionUUID->"b083987f-41d9-42a6-bf95-927926a0defb"],
Cell[54821, 1475, 16232, 440, 535, "Output",ExpressionUUID->"53fa24fd-4954-4a7a-a685-2d7229ed5ec6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71102, 1921, 136, 2, 59, "Subsection",ExpressionUUID->"8fb65fb5-83cd-42f1-ab32-3b6b13d9e63a"],
Cell[CellGroupData[{
Cell[71263, 1927, 1438, 34, 99, "Input",ExpressionUUID->"206e1e33-a298-4507-a4c3-6d581b5117dc"],
Cell[72704, 1963, 291, 9, 36, "Output",ExpressionUUID->"82e5c28f-91c2-4534-916f-cc1292d5167b"],
Cell[72998, 1974, 336, 11, 54, "Output",ExpressionUUID->"3950ec9a-b60d-489b-bdd8-2d442e9aadf1"],
Cell[73337, 1987, 364, 12, 54, "Output",ExpressionUUID->"04888ee8-1676-4555-a433-dcb57cc4482a"],
Cell[73704, 2001, 384, 13, 54, "Output",ExpressionUUID->"291cf37e-a445-4d03-a653-30d0944616e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74125, 2019, 1279, 28, 99, "Input",ExpressionUUID->"1ce68ad9-900d-4d87-819f-ca0ca94ba1f9"],
Cell[75407, 2049, 1395, 33, 91, "Output",ExpressionUUID->"e3d5c08f-9ee4-464b-9a32-2de88ad75e13"],
Cell[76805, 2084, 1752, 44, 111, "Output",ExpressionUUID->"755655f5-8a2f-4ae3-8492-3fcf34e9f4e1"],
Cell[78560, 2130, 2107, 54, 111, "Output",ExpressionUUID->"7c51481e-a7b8-484d-b2e1-b4165b58249e"],
Cell[80670, 2186, 2586, 67, 111, "Output",ExpressionUUID->"636aa04e-3b18-4f1d-ad7f-6bebdc740680"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83293, 2258, 1376, 29, 32, "Input",ExpressionUUID->"2ad16c02-3a06-407e-aff4-e563bd32e9b0"],
Cell[84672, 2289, 1873, 45, 53, "Output",ExpressionUUID->"9cff95b6-0986-4dc0-8ea4-4e1886d71742"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86582, 2339, 577, 14, 32, "Input",ExpressionUUID->"83c6ce52-5925-42f6-bd78-5d5eeffebfad"],
Cell[87162, 2355, 2249, 67, 93, "Output",ExpressionUUID->"5e2d6139-7e90-4823-9618-85f9814e271d"]
}, Open  ]],
Cell[89426, 2425, 2352, 68, 89, "Input",ExpressionUUID->"440f03df-ec82-4577-b882-66e920651f95"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91815, 2498, 169, 3, 59, "Subsection",ExpressionUUID->"54f47daa-68a4-4021-90e0-2e2aaf66a9d8"],
Cell[CellGroupData[{
Cell[92009, 2505, 411, 7, 49, "Subsubsection",ExpressionUUID->"7ba0bf3e-35de-45b1-bf44-0f1f4796edcd"],
Cell[92423, 2514, 411, 8, 32, "Input",ExpressionUUID->"23228031-a260-4b65-b6dc-34b1ff9ba92c"],
Cell[CellGroupData[{
Cell[92859, 2526, 768, 18, 32, "Input",ExpressionUUID->"a5372430-abc8-4b72-b9c8-dfaba981d87e"],
Cell[93630, 2546, 684, 14, 36, "Output",ExpressionUUID->"25e96763-5d16-447f-9c24-24babcd9d5f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94351, 2565, 275, 7, 32, "Input",ExpressionUUID->"26f024bb-81bf-42e2-b9f4-b3df608a5773"],
Cell[94629, 2574, 605, 13, 36, "Output",ExpressionUUID->"ada59923-1092-4024-b2bc-f3e008b47069"]
}, Open  ]],
Cell[95249, 2590, 989, 25, 50, "DisplayFormula",ExpressionUUID->"b9abbf0d-1d2e-487b-be4d-702e52680c1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96275, 2620, 390, 6, 49, "Subsubsection",ExpressionUUID->"17e7cbbd-b7d7-4806-90f5-67a5e48d0b5b"],
Cell[CellGroupData[{
Cell[96690, 2630, 1177, 26, 55, "Input",ExpressionUUID->"0b730f7e-590a-480a-94d5-22ef7dea11bc"],
Cell[97870, 2658, 2077, 58, 91, "Output",ExpressionUUID->"6597b8ba-b05c-4f6f-9340-fd4cbdd69a4e"]
}, Open  ]],
Cell[99962, 2719, 1104, 30, 55, "Input",ExpressionUUID->"085f44fd-2de0-455d-8843-54c8d3d272d8"],
Cell[CellGroupData[{
Cell[101091, 2753, 1050, 27, 32, "Input",ExpressionUUID->"1252b5fc-765c-4be1-b5ff-acb0182bd784"],
Cell[102144, 2782, 2826, 80, 81, "Output",ExpressionUUID->"56adfdbc-a8ad-48d7-a603-bc92da7bccf1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105007, 2867, 275, 7, 32, "Input",ExpressionUUID->"3e888c53-af4e-4f8f-a2f9-ef661b2107d5"],
Cell[105285, 2876, 6596, 184, 125, "Output",ExpressionUUID->"050b8889-9825-4d22-a0dc-f988317308f3"]
}, Open  ]],
Cell[111896, 3063, 989, 25, 50, "DisplayFormula",ExpressionUUID->"7dd37ece-0e80-4a9c-b76a-dbbc2bef0540"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112934, 3094, 216, 4, 59, "Subsection",ExpressionUUID->"a4dc4465-c7eb-43a8-8766-d322f53a37ab"],
Cell[113153, 3100, 893, 20, 26, "DisplayFormula",ExpressionUUID->"765cc099-cde3-460d-beb8-60ffcf655e98"],
Cell[114049, 3122, 1057, 24, 26, "DisplayFormula",ExpressionUUID->"e730f271-c4aa-4f92-b9a0-18dc7604b11b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

